;/*FB_PKG_DELIM*/

__d("E2EEUtils",["WebStorage"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var d;a=(d={},d[a]=String(b),d);(h||(h=c("WebStorage"))).setAllowlistedKeyToLocalStorage(h.getLocalStorage(),"isE2eeMandated",JSON.stringify(a))}function b(a){var b=(h||(h=c("WebStorage"))).getAllowlistedKeyFromLocalStorage("isE2eeMandated");if(b!=null){b=JSON.parse(b);return b[a]==="true"}else return!1}function d(a,b){var d;d=(d={},d[a]=String(b),d);var e=(h||(h=c("WebStorage"))).getAllowlistedKeyFromLocalStorage("hideE2eeAttributions");if(e!=null){d=babelHelpers["extends"]({},JSON.parse(e),(e={},e[a]=String(b),e))}h.setAllowlistedKeyToLocalStorage(h.getLocalStorage(),"hideE2eeAttributions",JSON.stringify(d))}function e(a){var b=(h||(h=c("WebStorage"))).getAllowlistedKeyFromLocalStorage("hideE2eeAttributions");if(b!=null){b=JSON.parse(b);return b[a]==="true"}else return!1}g.setLocalE2EEStatus=a;g.getLocalE2EEStatus=b;g.setLocalHideE2eeAttributions=d;g.getLocalHideE2eeAttributions=e}),98);
__d("RTWebCallWindowInitializer",["ConstUriUtils","E2EEUtils","RTWebDropInUtils","ZenonUserActionLogger","goURIOnWindow"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){this.$1=b}var b=a.prototype;b.initCall=async function(a,b){var c=b.context,e=b.isE2eeMandated,f=b.joinContext,g=b.mediaType,h=b.nonce;b=b.representedID;var i={alohaEscalatedMW:!1};if(!a)return i;var j,k=null,l,m,n=!1;if(c.intent==="accept invite"){var o=c.controllerParams;n=d("RTWebDropInUtils").isDropInFromAppMessages(o.appMessages);k=o.callContext;l={controllerParams:o};j=o.signalingID;m=[]}else j=c.signalingID,c.existingCall?l={existingCall:c.existingCall}:l=null,m=c.invitees;o=function(a){d("ZenonUserActionLogger").logEvent({call_id:j,call_type:"mw",checkpoint:a,conference_name:k!=null?k:null,event:"checkpoint",is_caller:m.length>0,media_type:g})};if(c.intent==="accept invite"&&n){o("load_dropin");return i}d("E2EEUtils").setLocalE2EEStatus(h,e!=null?e:!1);n=(c=f.type==="link"?d("ConstUriUtils").getUri(f.linkUrl):await this.$1.getCallUri({context:l,invitees:m,isE2eeMandated:e,mediaType:g,nonce:h,representedID:b,signalingID:j,thread:f.thread}))!=null?c:null;if(n===null){o("Failed to determine call URL");return i}o(n.toString());o("load_popup");this.__navigateToCallUri(n.toString(),a);return i};b.__navigateToCallUri=function(a,b){c("goURIOnWindow")(b,a),b.focus()};return a}();g.default=a}),98);
__d("RTWebMercuryCallWindowInitializer",["RTWebCallWindowInitializer","URI"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);var d=b.prototype;d.__navigateToCallUri=function(a,b){typeof b.location==="string"?b.location=a.toString():(h||(h=c("URI"))).goURIOnWindow(a.toString(),b,!0),b.focus()};return b}(c("RTWebCallWindowInitializer"));g["default"]=a}),98);
__d("ZenonUriBuilder",["ActorURI","FBLogger","RTWebIncomingRingConfiguration","XGroupCallControllerRouteBuilder","ZenonCallWindowErrors","ZenonSignalingProtocol","gkx","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h="ROOM:";a=function(){function a(a){this.__environment=a}var b=a.prototype;b.getCallUri=async function(a){var b,e=null;switch(a.thread.type){case 1:case 15:a.context&&a.context.controllerParams?a.context.controllerParams.configuration===c("ZenonSignalingProtocol").MW&&(e=a.context.controllerParams.callContext):e=this.$1(a);if(e===null)throw new(d("ZenonCallWindowErrors").ConferenceNameMutationFailedError)();b=await this.__getUriForMultiwayCall(a,{conferenceName:e});break;case 2:case 16:b=await this.__getUriForMultiwayCall(a);break;default:throw new(d("ZenonCallWindowErrors").UnsupportedThreadTypeError)()}if(!b)throw new(d("ZenonCallWindowErrors").ConferenceNameMutationFailedError)();e=new URLSearchParams(window.location.search);e=e.get("locale");e!=null&&(b.locale=e);e=c("XGroupCallControllerRouteBuilder").buildUri(b);var f=this.$2(e);a=a.representedID;return d("ActorURI").create((f=f==null?void 0:f.toString())!=null?f:e.toString(),a)};b.__getUriForMultiwayCall=function(a,b){var e=a.context,f=a.invitees,g=a.isE2eeMandated,i=a.mediaType,j=a.nonce,k=a.signalingID;a=a.thread;b===void 0&&(b={});var l,m;if(e&&e.controllerParams){l=e.controllerParams.callContext;m=e.controllerParams.serverInfoData;if(l==null)throw new(d("ZenonCallWindowErrors").IncompleteControllerParamsError)()}else{e=e==null?void 0:e.existingCall;m=(e==null?void 0:e.call_state)==="NO_ONGOING_CALL"?null:e==null?void 0:e.server_info_data;b.conferenceName!==void 0?l=b.conferenceName:l=h}e={call_context:l,call_id:k,has_video:i==="video",initialize_video:i==="video",is_e2ee_mandated:g,nonce:j,referrer_context:"zenon_precall",thread_type:a.type,users_to_ring:[].concat(f)};m!=null&&(e.server_info_data=m);l===h&&(e.use_joining_context=!0,a.type===1?e.peer_id=a.id:a.type===2&&(e.group_thread_id=a.id));if(g===!0)if(a.type===15){if(a.secureOneToOneThreadPeerId==null)throw c("unrecoverableViolation")("secureOneToOneThreadPeerId was null when setting up joining context for an e2ee thread","rtc_www");e.peer_id=a.secureOneToOneThreadPeerId}else if(a.type===16){if(a.e2eeThreadID==null)throw c("unrecoverableViolation")("e2eeThreadID was null when setting up joining context for an e2ee thread","rtc_www");e.group_thread_id=a.e2eeThreadID}e.peer_id==null&&c("gkx")("14244")&&(e.peer_id=a.id);return e};b.$1=function(a){a=a.thread;if(!d("RTWebIncomingRingConfiguration").isSupportedClient())return null;try{return a==null?null:h}catch(a){c("FBLogger")("rtc_www").catching(a).warn("Failed to fetch Messenger conference name for P2P call");return null}};b.$2=function(a){var b,d=a;if(!c("gkx")("24225"))return d;var e=new URLSearchParams(window.location.search);a=["gk_enable","gk_disable","multiway_www_tier","multiway_core_tier"];a.forEach(function(a){var b=e.get(a);if(b!=null){var c;d=(c=d)==null?void 0:c.addQueryParam(a,b)}});a=this.$3(e);d=(b=d)==null?void 0:b.addQueryParam("qe",Object.fromEntries(a));return d};b.$3=function(a){var b=/^(qe)\[(.*?)\]$/,c=new Map();for(a of a.entries()){var d=a[0];if(b.test(d)){var e=a[1];d=d.substring(3,d.lastIndexOf("]"));c.set(d,e)}}return c};return a}();g.default=a}),98);